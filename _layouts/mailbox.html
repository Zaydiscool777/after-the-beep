---
layout: base
---
{%- comment -%}
    List of all messages

    Parameters:
        page.marquee: text to show in marquee
        site.data.messages: list of message documents generated by fetchvm
{%- endcomment -%}


<div id="mailbox" class="mailbox">
    <a class="mailbox-number" href="tel:{{ site.data.site.number }}">
        <img class="mailbox-image" src="{% include static_url.fn filename='number.gif' %}" alt="{{ site.data.site.number }}" />
    </a>
    <div class="mailbox-controls">
        <div class="mailbox-infobox">
            Position
            <div class="mailbox-position">0:00</div>
        </div>
        <marquee class="mailbox-marquee" scrollamount="2" scrolldelay="20" truespeed>{% include party_text.html class="mailbox-letter" text=page.marquee %}</marquee>
        <div class="mailbox-infobox">
            Duration
            <div class="mailbox-duration">0:00</div>
        </div>
    </div>
    <div class="mailbox-controls">
        <div class="mailbox-state"></div>
        <input class="mailbox-seek" type="range" min="0" max="100" value="0" step="0.01" />
    </div>
    <div class="mailbox-controls">
        <button class="mailbox-prev"></button>
        <button class="mailbox-play"></button>
        <button class="mailbox-stop"></button>
        <button class="mailbox-next"></button>
        <div class="mailbox-spacer"></div>
        <button class="mailbox-mute"></button>
        <input class=" mailbox-volume" type="range" min="0" max="100" value="100" />
    </div>
    <div class="mailbox-messages">
        <table id="mailbox-table" class="mailbox-table" data-sorted-by="0">
            <thead>
                <tr>
                    <th class="mailbox-header mailbox-header-narrow" data-type="number" data-order="descending">#</th>
                    <th class="mailbox-header mailbox-header-narrow" data-type="time">Date</th>
                    <th class="mailbox-header mailbox-header-narrow" data-type="duration">Length</th>
                    <th class="mailbox-header " data-type="text">Memo</th>
                </tr>
            </thead>
            <tbody>
                {%- for message in site.messages reversed %}
                <tr class="mailbox-message" data-id="{{ message.local_id }}">
                    <td class="mailbox-message-number">{{ forloop.length | minus: forloop.index0 }}</td>
                    <td class="mailbox-message-date">{% include date.html date=message.date %}</td>
                    <td class="mailbox-message-duration">{{ message.duration }}</td>
                    <td class="mailbox-message-memo">{{ message.memo | markdownify | strip_newlines | remove: "<p>" | remove: "</p>" | remove: "\n" }}</td>
                </tr>
                {%- endfor %}
            </tbody>
        </table>
    </div>
</div>
<script src="{% include static_url.fn filename='mailbox.js' %}"></script>
<script src="{% include static_url.fn filename='table.js' %}"></script>
<script>
    (function() {
        mailbox.init('#mailbox', '{{ site.baseurl }}/messages/', function(message) {
            umami.track('Message.' + message.id + ': ' + message.memo);
        });
        table.init('#mailbox-table');
    })();
</script>
